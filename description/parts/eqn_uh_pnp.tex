%not a stand-alone document; intended for inclusion in a larger document

\section{Unhomogenized Poisson-Nernst-Planck Equation}\label{sec:unhom_pnp}

%-------------------------------------------------------------------------------
\subsection{Governing Differential Equation}\label{subsec:unhom_pnp_gov}


\textcolor{red}{\textbf{TODO}}: need reference for PNP equation

We consider $N_s$ ion species interacting through the an electrostatic potential.
The concentration field of each species is $c_s$, where $s=1 ... N_s$ is the index over the species.
The charge of each ion species is $z_s$, so that the volumetric charge density associated
with ion species $s$ is $z_s c_s$.
The overall volumetric charge density is therefore given by:

\begin{equation}
\rho = \sum_{s=1}^{N_s}z_s c_s
\end{equation}

From the Poisson equation, the electric potential is therefore governed by:

\begin{equation}
-\epsilon_{0}\epsilon_{r} \nabla^2 \Phi = \sum_{s=1}^{N_s}z_s c_s
\end{equation}

For each ionic species, the change in concentration over time is related to the ion flux as:

\begin{equation} 
\frac{\partial c_s}{\partial t} = - \nabla \cdot \vec{j}_s
\end{equation} 

with ion flux defined as:

\begin{equation}
\vec{j}_s  = -D_s \left( \nabla c_s + \beta z_s c_s \nabla \Phi \right)
\end{equation}

The governing equation for each ion species is therefore:

\begin{equation}
\frac{\partial c_s}{\partial t} = \nabla \cdot \left(
D_s \left( \nabla c_s + \beta z_s c_s \nabla \Phi \right)
\right)
\end{equation}

Under the assumption that the diffusion constant does not vary spatially,
this becomes:

\begin{equation}
\frac{\partial c_s}{\partial t} = 
D_s \left( \nabla^2 c_s + \beta z_s \nabla \cdot \left( c_s \nabla \Phi \right) \right)
\end{equation}

\begin{equation}
\frac{\partial c_s}{\partial t} = 
D_s \left( \nabla^2 c_s + \beta z_s \left( \nabla c_s \cdot \nabla \Phi \right)  + \beta z_s c_s \nabla^2 \Phi \right)
\end{equation}

The steady-state condition is therefore governed by

\begin{equation}\label{eq:PNP_steady_state_gov}
\nabla^2 c_s + \beta z_s \left( \nabla c_s \cdot \nabla \Phi \right)  + \beta z_s c_s \nabla^2 \Phi = 0
\end{equation}


%-------------------------------------------------------------------------------
\subsection{Weak Form}\label{subsec:unhom_pnp_weak}

\textcolor{red}{\textbf{TODO}}: provide weak form of Poisson equation

The weak form equation for each ion starts from Equation \ref{eq:PNP_steady_state_gov},
which is multiplied by a test function $v_s$ associated with the concentration $c_s$,
and then integrated over the problem domain.

\begin{equation}
\int_\Omega v_s \nabla^2 c_s \,\mathrm{d}^3x 
+ \beta z_s \int_\Omega c_s v_s \nabla^2 \Phi \,\mathrm{d}^3x
+ \beta z_s \int_\Omega  v_s \left( \nabla c_s \cdot \nabla \Phi \right) \,\mathrm{d}^3x
= 0
\end{equation}

Performing an integration by parts on the first two terms
using the product rule of Equation \ref{eq:product_rule_divergence}, this becomes

\begin{equation}
\int_\Omega \nabla \cdot \left( v_s \nabla c_s \right) \,\mathrm{d}^3x
- \int_\Omega \left( \nabla c_s \cdot \nabla v_s \right) \,\mathrm{d}^3x
+ \beta z_s \left( \int_\Omega \nabla \cdot \left( c_s v_s \nabla \Phi \right) \,\mathrm{d}^3x
- \int_\Omega \left( \nabla \left( c_s v_s \right)  \cdot \nabla \Phi \right) \,\mathrm{d}^3x \right)
+ \beta z_s \int_\Omega  v_s \left( \nabla c_s \cdot \nabla \Phi \right) \,\mathrm{d}^3x
= 0
\end{equation}

\textcolor{red}{\textbf{TODO}}
